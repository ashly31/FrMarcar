using System;
using Gtk;
using ControlAsistencia.Datos;
using ControlAsistencia.Entidades;
using Cairo;

namespace ControlAsistencia
{
    public partial class FrmMarcar : Gtk.Window
    {
        public Antialias universalAntiA = Antialias.Default;

        public FrmMarcar() :
                base(Gtk.WindowType.Toplevel)
        {
            this.Build();



            drawingArea.ModifyBg(StateType.Normal, new Gdk.Color(5, 5, 5));

            ClockStar();

        }

        void ClockStar()
        {
            GLib.Timeout.Add(100, new GLib.TimeoutHandler(Update));

        }

        bool Update()
        {
            DrawRing(drawingArea.GdkWindow);
            return true;

        }

        protected void OnBtnRegresarClicked(object sender, EventArgs e)
        {
            FrmLoginEmp frmLoginEmp = new FrmLoginEmp();

            frmLoginEmp.Show();
            this.Hide();
        }

        protected void OnBtnMarcarClicked(object sender, EventArgs e)
        {
            FrmMarcado frmConf = new FrmMarcado();

            ReporteEyS rpt = new ReporteEyS();

            if (this.TglBtnEntrada.Active)
            {
                rpt.Fecha = DateTime.Now;
                rpt.HoraEntrada = DateTime.Now;
            }
            else if (this.TglBtnSalida.Active)
            {
                rpt.HoraSalida = DateTime.Now;
            }



            frmConf.Show();
            this.Hide();
        }

        protected void OnTglBtnEntradaToggled(object sender, EventArgs e)
        {
            this.TglBtnSalida.Active = false;
        }

        protected void OnTglBtnSalidaToggled(object sender, EventArgs e)
        {
            this.TglBtnEntrada.Active = false;
        }

        public void DrawRing(Gdk.Window drawingArea)
        {
            int clockAmount = 0;
            double rotateAmount = 0;

            while(clockAmount < 12)
            {
                Cairo.Context ring = Gdk.CairoHelper.Create(drawingArea);

                PointD point1, point2;

                point1 = new PointD(85, 0);
                point2 = new PointD(95, 0);

                ring.Antialias = universalAntiA;
                ring.Translate(100, 100);
                ring.Rotate(0);
                ring.LineWidth = 4;
                ring.MoveTo(point1);
                ring.LineTo(point2);

                ring.SetSourceColor(new Cairo.Color(0.95, 0.95, 0.95));
                ring.Stroke();

                ring.GetTarget().Dispose();
                ring.Dispose();

            }
           

        }

     }


}
